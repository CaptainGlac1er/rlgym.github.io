"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[467],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var i=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,i,o=function(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=i.createContext({}),m=function(e){var t=i.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=m(e.components);return i.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return i.createElement(i.Fragment,{},t)}},u=i.forwardRef((function(e,t){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=m(n),u=o,f=p["".concat(s,".").concat(u)]||p[u]||d[u]||r;return n?i.createElement(f,a(a({ref:t},c),{},{components:n})):i.createElement(f,a({ref:t},c))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=n.length,a=new Array(r);a[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,a[1]=l;for(var m=2;m<r;m++)a[m]=n[m];return i.createElement.apply(null,a)}return i.createElement.apply(null,n)}u.displayName="MDXCreateElement"},9306:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>l,toc:()=>m});var i=n(7462),o=(n(7294),n(3905));const r={title:"Terminal Conditions"},a=void 0,l={unversionedId:"tutorials/terminal_conditions",id:"tutorials/terminal_conditions",title:"Terminal Conditions",description:"Terminal Conditions",source:"@site/docs/tutorials/terminal_conditions.md",sourceDirName:"tutorials",slug:"/tutorials/terminal_conditions",permalink:"/rlgym.github.io/docs/tutorials/terminal_conditions",draft:!1,tags:[],version:"current",frontMatter:{title:"Terminal Conditions"},sidebar:"tutorialSidebar",previous:{title:"State Setters",permalink:"/rlgym.github.io/docs/tutorials/state_setters"},next:{title:"Tools",permalink:"/rlgym.github.io/docs/tools/"}},s={},m=[{value:"Terminal Conditions",id:"terminal-conditions",level:2}],c={toc:m};function p(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,i.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"terminal-conditions"},"Terminal Conditions"),(0,o.kt)("p",null,"A ",(0,o.kt)("inlineCode",{parentName:"p"},"TerminalCondition")," is a simple object that examines the current game state and returns ",(0,o.kt)("inlineCode",{parentName:"p"},"True")," if that state should be the final state in an episode, and ",(0,o.kt)("inlineCode",{parentName:"p"},"False")," otherwise.\nTerminal conditions can be paired together in a list, in which case an episode will be terminated if any of the provided terminal conditions are evaluated to ",(0,o.kt)("inlineCode",{parentName:"p"},"True"),"."),(0,o.kt)("p",null,"A terminal condition must implement two methods:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"#Called once per reset.\nreset(self, initial_state: GameState)\n\n#Called once per step.\nis_terminal(self, current_state: GameState) -> bool\n")),(0,o.kt)("p",null,"To write a custom terminal condition, inherit from the parent class and implement the above methods."),(0,o.kt)("p",null,"As an example, let's implement a custom terminal condition that will end an episode as soon as any player touches the ball."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"from rlgym.utils.terminal_conditions import TerminalCondition\nfrom rlgym.utils.gamestates import GameState\n\n\nclass CustomTerminalCondition(TerminalCondition):\n  def reset(self, initial_state: GameState):\n    pass\n\n  def is_terminal(self, current_state: GameState) -> bool:\n    return current_state.last_touch != -1\n")),(0,o.kt)("p",null,"And just like that, we're done!"),(0,o.kt)("p",null,"Now all we have to do is pass our terminal condition into RLGym in the form of a ",(0,o.kt)("inlineCode",{parentName:"p"},"list"),", like so:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"import rlgym\n\n\nenv = rlgym.make(terminal_conditions=[CustomTerminalCondition()])\n#Training loop goes here\n")),(0,o.kt)("p",null,"RLGym will now terminate an episode only when the ball has been touched by any player in the match. However, if we're training an agent with random initial parameters, it may\ntake quite some time in the early stages of training for any player to accidentally touch the ball. Because of this, it might be useful for us to terminate an episode if a\nplayer has touched the ball or if some number of seconds have passed in the game."),(0,o.kt)("p",null,"To do this, we can leverage the existing ",(0,o.kt)("inlineCode",{parentName:"p"},"TimeoutCondition")," that comes with RLGym natively in combination with our custom terminal condition. Let's say we want an episode to end\nafter 20 seconds of in-game time or if a player has touched the ball. All we need to do is compute how many ",(0,o.kt)("inlineCode",{parentName:"p"},"env.step()")," calls it will take for 20 seconds to pass in the game,\nand pass that in to the constructor of ",(0,o.kt)("inlineCode",{parentName:"p"},"TimeoutCondition"),". Then we can simply add the timeout condition to our list of terminal conditions when we ask RLGym to make an\nenvironment, and we're done!"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-python"},"import rlgym\nfrom rlgym.utils.terminal_conditions.common_conditions import TimeoutCondition\n\ndefault_tick_skip = 8\nphysics_ticks_per_second = 120\nep_len_seconds = 20\n\nmax_steps = int(round(ep_len_seconds * physics_ticks_per_second / default_tick_skip))\n\ncondition1 = TimeoutCondition(max_steps)\ncondition2 = CustomTerminalCondition()\n\nenv = rlgym.make(terminal_conditions=[condition1, condition2])\n#Training loop goes here\n")),(0,o.kt)("p",null,"Now we've successfully configured multiple terminal conditions for our environment!"))}p.isMDXComponent=!0}}]);